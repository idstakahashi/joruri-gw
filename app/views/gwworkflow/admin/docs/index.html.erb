<div class="bbsDocList workflow">
<%= render 'piece_header' %>

<div class="pieceBody">
<%= render 'header' %>
<%= render 'search' %>

<table class="index">
  <tr class="headIndex">
    <th style="width:60px;">状態</th>
    <th class="docTitle">タイトル</th>
    <th style="width:60px;">承認状況</th>
    <% if params[:cond].in?(%w(processing processed)) %>
    <th style="width:120px;">作成者</th>
    <% end %>
    <th style="width:120px;">申請日時</th>
    <th style="width:120px;">期限日時</th>
    <th style="width:120px;">最終更新日時</th>
  </tr>
  <% @records.each do |record| %>
    <tr class="<%= cycle 'article', 'article cycle' %><%= " expired" if record.item.expired? && record.item.unfinished? %>">
    <td><%= raw(record.state_str) %></td>
    <td class="docTitle">
      <% action = params[:cond] == 'processing' ? :approve : :show %>
      <%= link_to record.title, {action: action, id: record.id} %>
    </td>
    <td><%= raw(record.progress_str) %></td>
    <% if params[:cond].in?(%w(processing processed)) %>
    <td><%= record.item.creater_name %></td>
    <% end %>
    <td class="update"><%=l record.applied_at rescue "未設定" %></td>
    <td class="update"><%=l record.expired_at rescue "未設定" %></td>
    <td class="update"><%=l record.updated_at rescue "未設定" %></td>
    </tr>
  <% end %>
</table>

<%= paginate @items %>

</div><!--pieceBody-->
</div><!--bbsDocList workflow-->
