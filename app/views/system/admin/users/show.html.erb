<div class="piece AdminSetting AdminUsers">
<%= render 'header' %>

<div class="pieceBody">
<%= render 'header_menu' %>

<div class="editingBox">
  <span class="btEdit">
    <%= link_to "編集", {action: :edit} if @item.editable? %>
  </span>
  <% if @role_admin %>
  <span class="btDestroy">
    <%= link_to "削除", {action: :destroy}, method: :delete, confirm: '状態を無効にしてよろしいですか？' if @item.deletable? %>
  </span>
  <% end %>
</div>

<table class="show">
  <tr>
    <th>ユーザーID</th>
    <td><%= @item.code -%></td>
  </tr>
  <tr>
    <th>ユーザー名</th>
    <td><%= @item.name -%></td>
  </tr>
  <tr>
    <th>ユーザー名(英語表記)</th>
    <td><%= @item.name_en -%></td>
  </tr>
  <tr>
    <th>メールアドレス</th>
    <td><%= @item.email -%></td>
  </tr>
  <tr>
    <th>役職</th>
    <td><%= @item.official_position -%></td>
  </tr>
  <tr>
    <th>担当</th>
    <td><%= @item.assigned_job -%></td>
  </tr>
  <tr>
    <th>表示順</th>
    <td><%= @item.sort_no -%></td>
  </tr>
</table>

<table class="show">
  <tr>
    <th>状態</th>
    <td><%= System::UsersGroup.state_show(@item.state) -%></td>
  </tr>
  <tr>
    <th>LDAP同期</th>
    <td><%= System::UsersGroup.ldap_show(@item.ldap) -%></td>
  </tr>
  <tr>
    <th>パスワード</th>
    <td><%= @item.password -%></td>
  </tr>
  <tr>
    <th>モバイルアクセス</th>
    <td><%= @item.mobile_access_label -%></td>
  </tr>
  <tr>
    <th>モバイルパスワード</th>
    <td><%= @item.mobile_password -%></td>
  </tr>
</table>

<br/>
<div>ユーザーの所属</div>
<div class="editingBox">
  <span class="btNew"><%= link_to '新規作成', new_system_users_group_path(0, user_id: @item.id) %></span>
</div>
<% if @item.user_groups.size > 0 %>
<table class="index">
  <colgroup class="_groups"></colgroup>
  <colgroup class="start_at"></colgroup>
  <colgroup class="end_at"></colgroup>
  <colgroup class="job_order"></colgroup>
  <colgroup class="_g_start_at"></colgroup>
  <colgroup class="_g_end_at"></colgroup>
  <colgroup class="_level"></colgroup>
  <colgroup class="_parent_name"></colgroup>
  <tbody>
    <tr>
      <% if @role_admin %>
      <th>詳細</th>
      <% end %>
      <th>グループ</th>
      <th>配属開始日</th>
      <th>配属終了日</th>
      <th>本務・兼務</th>
      <th>適用開始日</th>
      <th>適用終了日</th>
      <th>階層</th>
      <th>上位所属</th>
    </tr>
    <% @item.user_groups.each do |ug| %>
      <tr>
        <% if @role_admin %>
        <td><%= link_to '詳細', system_users_group_path(ug.group_id, ug.rid) %></td>
        <% end %>
        <td><%= ug.show_group_name -%></td>
        <td><%=l ug.start_at, format: :date if ug.start_at -%></td>
        <td><%=l ug.end_at, format: :date if ug.end_at -%></td>
        <td><%= System::UsersGroup.job_order_show(ug.job_order) -%></td>
        <td><%=l ug.group.start_at, format: :date if ug.group && ug.group.start_at -%></td>
        <td><%=l ug.group.end_at, format: :date if ug.group && ug.group.end_at -%></td>
        <td><%= ug.group.level_no if ug.group -%></td>
        <td><%= ug.group.parent.name if ug.group && ug.group.parent -%></td>
      </tr>
    <% end %>
  </tbody>
</table>
<% else %>
<div class="notice">所属は登録されていません。</div>
<% end %>

<div class="btReturn">
  <%= link_to '戻る', {action: :index} %>
</div>

</div>
</div>
